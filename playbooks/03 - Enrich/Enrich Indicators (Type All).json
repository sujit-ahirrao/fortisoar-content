{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Enrich Indicators (Type All)",
    "aliasName": null,
    "tag": "#Subroutine",
    "description": "Get indicator reputation from all available pluggable enrichment playbooks",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "indicator_value",
        "indicator_type",
        "indicator_IRI",
        "indicator_file_IRI",
        "indicator_file_name"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/deaa4d19-7444-4f3a-a80e-9577436f25ef",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/3a4098d5-3ec4-42bc-94e2-8f63bfed103f",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Initialize Enrichment Playbooks List",
            "description": null,
            "arguments": {
                "when": "{{vars.steps.Get_Enrichment_Playbooks_List.data['hydra:member'] | length == 0}}",
                "arguments": {
                    "enrichmentTag": "{{vars.enrichmentTag}}",
                    "enrichmentGlobalVar": "{{vars.enrichmentGlobalVarForType}}"
                },
                "apply_async": false,
                "step_variables": {
                    "enrichmentPlaybooksList": "{{vars.result.data.value}}"
                },
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/e1fbff9b-8397-4b2e-afd7-676251acf064"
            },
            "status": null,
            "top": "580",
            "left": "1040",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "2e62a551-037c-4a68-ade3-a6cf4186a487"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Suspicious",
            "description": null,
            "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Suspicious\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Suspicious"
            },
            "status": null,
            "top": "800",
            "left": "2160",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "3019b0d0-df56-4738-b599-8752a82af23e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Enrichment Playbooks List",
            "description": null,
            "arguments": {
                "params": {
                    "iri": "\/api\/wf\/api\/dynamic-variable\/?limit=40&name={{vars.enrichmentGlobalVarForType}}",
                    "body": "",
                    "method": "GET"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": {
                    "enrichmentPlaybooksList": "{% if vars.result.data['hydra:member'] | length > 0 %}{{vars.result.data['hydra:member'][0].value}}{% endif %}"
                }
            },
            "status": null,
            "top": "460",
            "left": "1040",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "38b44efe-c444-42c9-b0d9-a8efbfe3a0c6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": "Indicator reputation is set as 'TBD' by 'Create and Link Indicator' utility playbook. We can ignore those indicators when triggering this PB",
            "arguments": {
                "resource": "indicators",
                "resources": [
                    "indicators"
                ],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    },
                    "indicator_type": "{{vars.input.params['indicator_type'] | ternary(vars.input.params['indicator_type'],vars.input.records[0].typeofindicator.itemValue) }}",
                    "indicator_value": "{% if vars.input.records[0].typeofindicator.itemValue == \"File\" %}{\"indicator_file_IRI\": \"{{vars.input.params['indicator_file_IRI'] | ternary(vars.input.params['indicator_file_IRI'],vars.input.records[0].file['@id']) }}\", \"indicator_file_name\": \"{{vars.input.params['indicator_file_name'] | ternary(vars.input.params['indicator_file_name'],vars.input.records[0].file.filename) }}\" }{% else %}{{vars.input.params['indicator_value'] | ternary(vars.input.params['indicator_value'],vars.input.records[0].value) }}{% endif %}",
                    "enrichment_playbooks_global_vars_map": "{\n\"Domain\":\"{{globalVars.Domain_Enrichment_Playbooks_IRIs}}\",\n\"Email Address\":\"{{globalVars.Email_Enrichment_Playbooks_IRIs}}\",\n\"Host\":\"{{globalVars.Host_Enrichment_Playbooks_IRIs}}\",\n\"File\":\"{{globalVars.File_Enrichment_Playbooks_IRIs}}\",\n\"FileHash-MD5\":\"{{globalVars.FileHash_Enrichment_Playbooks_IRIs}}\",\n\"FileHash-SHA1\":\"{{globalVars.FileHash_Enrichment_Playbooks_IRIs}}\",\n\"FileHash-SHA256\":\"{{globalVars.FileHash_Enrichment_Playbooks_IRIs}}\",\n\"IP Address\":\"{{globalVars.IP_Enrichment_Playbooks_IRIs}}\",\n\"Port\":\"{{globalVars.Port_Enrichment_Playbooks_IRIs}}\",\n\"Registry\":\"{{globalVars.Registry_Enrichment_Playbooks_IRIs}}\",\n\"Process\":\"{{globalVars.Process_Enrichment_Playbooks_IRIs}}\",\n\"URL\":\"{{globalVars.URL_Enrichment_Playbooks_IRIs}}\",\n\"User\":\"{{globalVars.User_Enrichment_Playbooks_IRIs}}\"\n}"
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "logic": "OR",
                            "filters": [
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/5a5a7d42-be27-4903-858a-19909ebfa1eb",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/5a5a7d42-be27-4903-858a-19909ebfa1eb",
                                        "itemValue": "Domain"
                                    },
                                    "operator": "eq"
                                },
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/0ca054f2-d923-4992-a4a7-c516e6df281e",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/0ca054f2-d923-4992-a4a7-c516e6df281e",
                                        "itemValue": "FileHash-MD5"
                                    },
                                    "operator": "eq"
                                },
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/143e40b0-e643-468d-b968-a542fc85f08d",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/143e40b0-e643-468d-b968-a542fc85f08d",
                                        "itemValue": "FileHash-SHA1"
                                    },
                                    "operator": "eq"
                                },
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/4ea7b083-a0af-41ea-8d7c-7ace16021722",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/4ea7b083-a0af-41ea-8d7c-7ace16021722",
                                        "itemValue": "FileHash-SHA256"
                                    },
                                    "operator": "eq"
                                },
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                                        "itemValue": "IP Address"
                                    },
                                    "operator": "eq"
                                },
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/353a37b4-3eeb-43ee-aac6-64806422cfec",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/353a37b4-3eeb-43ee-aac6-64806422cfec",
                                        "itemValue": "URL"
                                    },
                                    "operator": "eq"
                                },
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/80bd55b0-6d88-4beb-bec3-97954f261c4d",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/80bd55b0-6d88-4beb-bec3-97954f261c4d",
                                        "itemValue": "Email Address"
                                    },
                                    "operator": "eq"
                                },
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/0162241b-f5bf-4917-a150-00e920be47bd",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/0162241b-f5bf-4917-a150-00e920be47bd",
                                        "itemValue": "File"
                                    },
                                    "operator": "eq"
                                },
                                {
                                    "type": "object",
                                    "field": "typeofindicator",
                                    "value": "\/api\/3\/picklists\/e72907c5-2088-4e85-99d0-6c7970a5470e",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/e72907c5-2088-4e85-99d0-6c7970a5470e",
                                        "display": "User",
                                        "itemValue": "User"
                                    },
                                    "operator": "eq"
                                }
                            ]
                        },
                        {
                            "logic": "AND",
                            "filters": [
                                {
                                    "type": "object",
                                    "field": "indicatorStatus",
                                    "value": "\/api\/3\/picklists\/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                                        "itemValue": "Excluded"
                                    },
                                    "operator": "neq"
                                }
                            ]
                        },
                        {
                            "logic": "OR",
                            "filters": [
                                {
                                    "type": "object",
                                    "field": "reputation",
                                    "value": "true",
                                    "_value": {
                                        "@id": "true",
                                        "display": "",
                                        "itemValue": ""
                                    },
                                    "operator": "isnull"
                                },
                                {
                                    "type": "object",
                                    "field": "reputation",
                                    "value": "\/api\/3\/picklists\/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                                        "itemValue": "TBD"
                                    },
                                    "operator": "eq"
                                }
                            ]
                        }
                    ]
                }
            },
            "status": null,
            "top": "40",
            "left": "260",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "group": null,
            "uuid": "3a4098d5-3ec4-42bc-94e2-8f63bfed103f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set No Reputation",
            "description": null,
            "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"No Reputation Available\"))[\"@id\"]}}",
                "Reputation_Type_Text": "No Reputation Available"
            },
            "status": null,
            "top": "1100",
            "left": "2160",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "3d7cb74b-d060-4933-9ebe-67579f88452b"
        },
        {
            "@type": "WorkflowStep",
            "name": "No Integration Available",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "content": "<p>No integration available for enrichment<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "reputation": "\/api\/3\/picklists\/9a611980-1b5e-4ae9-8062-eb2c0c433cff",
                    "enrichmentStatus": "\/api\/3\/picklists\/c6e46fde-97a2-48cc-8019-938c9c5aebd0"
                },
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "520",
            "left": "1680",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "4d9603ae-2f1c-48ed-a61a-60704a608db8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Dedicated Tenant Record",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes, Enrich at Tenant Node",
                        "step_iri": "\/api\/3\/workflow_steps\/678a25cd-14af-49c7-9ea8-c3452585b910",
                        "condition": "{{ 'tenant' in vars.input.records[0] and vars.input.records[0].tenant.isDedicated and vars.input.records[0].tenant.role != 'self' }}",
                        "step_name": "Enrichment on Tenant"
                    },
                    {
                        "option": "No, Enrich here",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/fbe06a74-ed1b-4e6c-9ab6-98350daed35f",
                        "step_name": "Configuration"
                    }
                ]
            },
            "status": null,
            "top": "160",
            "left": "260",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "50a9c51c-6dbb-412c-83b3-fad2d88a9392"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Supported Indicator Type",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "No",
                        "step_iri": "\/api\/3\/workflow_steps\/a61c987a-3864-49a0-b0b9-8802e00805d2",
                        "condition": "{{ vars.enrichmentGlobalVarForType == \"NotSupported_Playbooks_IRIs\" }}",
                        "step_name": "Exit"
                    },
                    {
                        "option": "Yes",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/38b44efe-c444-42c9-b0d9-a8efbfe3a0c6",
                        "step_name": "Get Enrichment Playbooks List"
                    }
                ]
            },
            "status": null,
            "top": "460",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "50ce2052-a344-4374-9b94-e528860c111f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Additional Checks for IP",
            "description": null,
            "arguments": {
                "arguments": {
                    "style_colors": "{{vars.style_colors}}",
                    "indicator_value": "{{vars.indicator_value}}",
                    "enrichmentPlaybooksList": "{{vars.enrichmentPlaybooksList.split(\",\")}}"
                },
                "apply_async": false,
                "ignore_errors": false,
                "step_variables": [],
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/846a0e87-c5e9-4181-a9ab-f3b3f1e521cb"
            },
            "status": null,
            "top": "800",
            "left": "1380",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "5e280ff6-13e6-49eb-878a-217923163080"
        },
        {
            "@type": "WorkflowStep",
            "name": "Enrichment on Tenant",
            "description": null,
            "arguments": {
                "params": [],
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "260",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "678a25cd-14af-49c7-9ea8-c3452585b910"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute Reputation Data",
            "description": null,
            "arguments": {
                "verdicts": "{{(vars.steps.Get_Indicator_Reputation| json_query('[].verdict')) or (vars.steps.Additional_Checks_for_IP | json_query('[].verdict')) or (vars.steps.Additional_Checks_for_IP.verdict)}}",
                "cti_names": "{{(vars.steps.Get_Indicator_Reputation|json_query('[].cti_name')) or (vars.steps.Additional_Checks_for_IP | json_query('[].cti_name'))}}",
                "cti_scores": "{{(vars.steps.Get_Indicator_Reputation|json_query('[].cti_score')) or (vars.steps.Additional_Checks_for_IP | json_query('[].cti_score'))}}",
                "source_data": "{% set sd = {} %}{% if vars.indicator_type == 'IP Address' %}{% for item in vars.steps.Additional_Checks_for_IP %}{% if item.source_data is defined %}{% set _ = sd.update(item.source_data) %}{% endif %}{% endfor %}{% else %}{% for item in vars.steps.Get_Indicator_Reputation %}{% if item.source_data is defined %}{% set _ = sd.update(item.source_data) %}{% endif %}{% endfor %}{% endif %}{{sd}}",
                "field_mapping": "{% set fm = {} %}{% if vars.indicator_type == 'IP Address' %}{% for item in vars.steps.Additional_Checks_for_IP %}{% if item.field_mapping is defined %}{% set _ = fm.update(item.field_mapping) %}{% endif %}{% endfor %}{% else %}{% for item in vars.steps.Get_Indicator_Reputation %}{% if item.field_mapping is defined %}{% set _ = fm.update(item.field_mapping) %}{% endif %}{% endfor %}{% endif %}{% set nfm = {} %}{% for k,v in fm.items() %}{% if not v == None %}{% set _ = nfm.update({k: v})  %}{% endif %}{% endfor %}{% if nfm.lastSeen is defined %}{% set ls = nfm.get('lastSeen') %}{% if not ls is integer %}{% set _ = nfm.update({'lastSeen': (arrow.get(ls).int_timestamp)}) %}{%endif%}{% endif %}{% if nfm.firstSeen is defined %}{% set fs = nfm.get('firstSeen') %}{% if not fs is integer %}{% set _ = nfm.update({'firstSeen': (arrow.get(fs).int_timestamp)}) %}{% endif %}{% endif %}{% if nfm.tlp is defined %}{% set tlp = (nfm.get('tlp') | capitalize) %}{% if tlp %}{% set iri = (\"TrafficLightProtocol\" | picklist(tlp, \"@id\")) %}{% set _ = nfm.update({'tlp': iri}) %}{% endif %}{% endif %}{{nfm}}",
                "is_private_ip": "{{vars.steps.Additional_Checks_for_IP.is_private_ip or vars.is_private_ip}}",
                "enrichment_summaries": "{{vars.steps.Get_Indicator_Reputation|json_query('[].enrichment_summary') or (vars.steps.Additional_Checks_for_IP | json_query('[].enrichment_summary')) or (vars.steps.Additional_Checks_for_IP.enrichment_summary)}}"
            },
            "status": null,
            "top": "800",
            "left": "1680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "8c18e496-91ba-4f0c-8301-917829cc2060"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Good",
            "description": null,
            "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Good\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Good"
            },
            "status": null,
            "top": "980",
            "left": "2160",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "90602b79-d420-44dd-95ad-c06e6c107585"
        },
        {
            "@type": "WorkflowStep",
            "name": "Identify Enrichment Playbooks List",
            "description": null,
            "arguments": {
                "enrichmentTag": "\/api\/3\/tags\/{{vars.enrichmentTags.get(vars.indicator_type, \"NotSupported\")}}",
                "enrichmentGlobalVarForType": "{{vars.enrichmentTags.get(vars.indicator_type, \"NotSupported\")}}_Playbooks_IRIs"
            },
            "status": null,
            "top": "360",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "95b508b7-10bc-4794-abd4-d75663111f73"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Indicator Reputation",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.enrichmentPlaybooksList.split(\",\")}}",
                    "__bulk": false,
                    "parallel": true,
                    "condition": ""
                },
                "arguments": {
                    "style_colors": "{{vars.style_colors}}",
                    "indicator_value": "{{vars.indicator_value}}"
                },
                "apply_async": false,
                "ignore_errors": true,
                "step_variables": [],
                "pass_input_record": true,
                "workflowReference": "{{vars.item}}"
            },
            "status": null,
            "top": "680",
            "left": "1680",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "9b6a0035-6c1a-4cd5-8638-1ea33b94ab6b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Exit",
            "description": null,
            "arguments": {
                "temp": "no_op"
            },
            "status": null,
            "top": "560",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "a61c987a-3864-49a0-b0b9-8802e00805d2"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Field Mapping",
            "description": null,
            "arguments": {
                "when": "{{vars.field_mapping | length > 0}}",
                "params": {
                    "iri": "{{vars.input.records[0]['@id']}}",
                    "body": "{{vars.field_mapping}}"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "update_cyops_resource",
                "operationTitle": "FSR: Update Record",
                "step_variables": []
            },
            "status": null,
            "top": "980",
            "left": "3220",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "acc4c661-464c-4c5d-b58d-b0e7a88008ee"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Type IP",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/5e280ff6-13e6-49eb-878a-217923163080",
                        "condition": "{{ vars.indicator_type == 'IP Address' }}",
                        "step_name": "Additional Checks for IP"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/ea51391e-d9b2-4af6-ac63-497e61419238",
                        "step_name": "Integrations Available for Enrichment"
                    }
                ]
            },
            "status": null,
            "top": "700",
            "left": "1040",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "ba6f3981-1789-4635-8784-02b7ad23f655"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Referenced",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Referenced",
                        "step_iri": "\/api\/3\/workflow_steps\/ff1cda79-4318-46df-afd2-febe2d72c076",
                        "condition": "{{ vars.is_referenced }}",
                        "step_name": "Summary"
                    },
                    {
                        "option": "Upon Create",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/f250ed61-15a3-458b-9436-7480c809f3ef",
                        "step_name": "Update Record"
                    }
                ]
            },
            "status": null,
            "top": "880",
            "left": "2540",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "dd6f68af-fb89-41c3-9d36-036299d96c6d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Malicious",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Malicious",
                        "step_iri": "\/api\/3\/workflow_steps\/f9efb396-4f6d-496e-95b7-8132b4357f86",
                        "condition": "{{ \"Malicious\" in vars.verdicts }}",
                        "step_name": "Set Malicious"
                    },
                    {
                        "option": "No Reputation",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/3d7cb74b-d060-4933-9ebe-67579f88452b",
                        "step_name": "Set No Reputation"
                    },
                    {
                        "option": "Suspicious",
                        "step_iri": "\/api\/3\/workflow_steps\/3019b0d0-df56-4738-b599-8752a82af23e",
                        "condition": "{{ \"Suspicious\" in vars.verdicts }}",
                        "step_name": "Set Suspicious"
                    },
                    {
                        "option": "Good",
                        "step_iri": "\/api\/3\/workflow_steps\/90602b79-d420-44dd-95ad-c06e6c107585",
                        "condition": "{{ \"Good\" in vars.verdicts }}",
                        "step_name": "Set Good"
                    }
                ]
            },
            "status": null,
            "top": "920",
            "left": "1680",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "ddc214f4-d9c0-4600-b2e9-af0df3bc0377"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Enrichment Status to In Progress",
            "description": null,
            "arguments": {
                "when": "{{not vars.input.params['indicator_value'] == None}}",
                "resource": {
                    "enrichmentStatus": "\/api\/3\/picklists\/8a4609d2-8a3d-4bda-9888-5f00bfea43cb"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "260",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "e7e931fb-79a9-422a-beb2-bfcee6012817"
        },
        {
            "@type": "WorkflowStep",
            "name": "Has Integrations Available for Enrichment",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/9b6a0035-6c1a-4cd5-8638-1ea33b94ab6b",
                        "condition": "{{ \"\/api\/3\/workflows\" in vars.enrichmentPlaybooksList }}",
                        "step_name": "Get Indicator Reputation"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/4d9603ae-2f1c-48ed-a61a-60704a608db8",
                        "step_name": "No Integration Available"
                    }
                ]
            },
            "status": null,
            "top": "620",
            "left": "1380",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "ea51391e-d9b2-4af6-ac63-497e61419238"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Record",
            "description": null,
            "arguments": {
                "resource": {
                    "reputation": "{{vars.Reputation_Type_IRI}}",
                    "sourceData": "{{vars.source_data | toJSON}}",
                    "description": "{% if vars.is_private_ip %}{{vars.enrichment_summaries}}{% else %}{% for item in vars.steps.Additional_Checks_for_IP %}{{item.enrichment_summary}}{% endfor %}{% for item in vars.steps.Get_Indicator_Reputation %}{{item.enrichment_summary}}{% endfor %}{% endif %}",
                    "enrichmentStatus": "\/api\/3\/picklists\/c6e46fde-97a2-48cc-8019-938c9c5aebd0"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "980",
            "left": "2880",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "f250ed61-15a3-458b-9436-7480c809f3ef"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Malicious",
            "description": null,
            "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Malicious\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Malicious"
            },
            "status": null,
            "top": "700",
            "left": "2160",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "f9efb396-4f6d-496e-95b7-8132b4357f86"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "style_colors": "{\n\"Good\": \"#52c91a\",\n\"Malicious\": \"#c42323\",\n\"Suspicious\": \"#dbc030\",\n\"TBD\": \"#696969\",\n\"No Reputation Available\": \"#6a9169\"\n}",
                "is_private_ip": "false",
                "is_referenced": "{% if vars.input.params['indicator_type'] == \"File\" and vars.input.params['indicator_file_IRI'] | length > 0 %}{{true}}{% elif vars.input.params['indicator_value'] | length > 0 %}{{true}}{% else %}{{false}}{% endif %}",
                "enrichmentTags": "{\"File\": \"File_Enrichment\",\"IP Address\": \"IP_Enrichment\",\"URL\": \"URL_Enrichment\",\"Domain\": \"Domain_Enrichment\",\"Email Address\": \"Email_Enrichment\",\"FileHash-MD5\": \"FileHash_Enrichment\",\"FileHash-SHA1\": \"FileHash_Enrichment\",\"FileHash-SHA256\": \"FileHash_Enrichment\", \"User\": \"User_Enrichment\"}"
            },
            "status": null,
            "top": "160",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "fbe06a74-ed1b-4e6c-9ab6-98350daed35f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Summary",
            "description": null,
            "arguments": {
                "reputation": "{{vars.Reputation_Type_Text}}",
                "reputation_iri": "{{vars.Reputation_Type_IRI}}",
                "enrichment_summaries": "{{vars.enrichment_summaries}}"
            },
            "status": null,
            "top": "740",
            "left": "2880",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "ff1cda79-4318-46df-afd2-febe2d72c076"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Has Integrations Available for Enrichment -> Get Indicator Reputation",
            "targetStep": "\/api\/3\/workflow_steps\/9b6a0035-6c1a-4cd5-8638-1ea33b94ab6b",
            "sourceStep": "\/api\/3\/workflow_steps\/ea51391e-d9b2-4af6-ac63-497e61419238",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "2a6564b2-6ba7-4acd-9edb-2cb0dc5b5893"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Indicator Reputation -> Compute Reputation Data",
            "targetStep": "\/api\/3\/workflow_steps\/8c18e496-91ba-4f0c-8301-917829cc2060",
            "sourceStep": "\/api\/3\/workflow_steps\/9b6a0035-6c1a-4cd5-8638-1ea33b94ab6b",
            "label": null,
            "isExecuted": false,
            "uuid": "ab4e0f09-a1d3-4857-aae3-8eab06ee19ff"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Integrations Available for Enrichment -> No Integration Available",
            "targetStep": "\/api\/3\/workflow_steps\/4d9603ae-2f1c-48ed-a61a-60704a608db8",
            "sourceStep": "\/api\/3\/workflow_steps\/ea51391e-d9b2-4af6-ac63-497e61419238",
            "label": "No",
            "isExecuted": false,
            "uuid": "2c76d783-403b-428c-aa1a-0f1a42016837"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Additional Checks for IP -> Compute Reputation Data",
            "targetStep": "\/api\/3\/workflow_steps\/8c18e496-91ba-4f0c-8301-917829cc2060",
            "sourceStep": "\/api\/3\/workflow_steps\/5e280ff6-13e6-49eb-878a-217923163080",
            "label": null,
            "isExecuted": false,
            "uuid": "5a08d541-87bd-46bb-a491-b1484011c553"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious -> Set Suspicious",
            "targetStep": "\/api\/3\/workflow_steps\/3019b0d0-df56-4738-b599-8752a82af23e",
            "sourceStep": "\/api\/3\/workflow_steps\/ddc214f4-d9c0-4600-b2e9-af0df3bc0377",
            "label": "Suspicious",
            "isExecuted": false,
            "uuid": "91107552-eebd-4af6-ab1c-48d25de0cd0a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Good -> Is Referenced",
            "targetStep": "\/api\/3\/workflow_steps\/dd6f68af-fb89-41c3-9d36-036299d96c6d",
            "sourceStep": "\/api\/3\/workflow_steps\/90602b79-d420-44dd-95ad-c06e6c107585",
            "label": null,
            "isExecuted": false,
            "uuid": "5fe098e8-9505-4928-b658-459bfbbabccd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Suspicious -> Is Referenced",
            "targetStep": "\/api\/3\/workflow_steps\/dd6f68af-fb89-41c3-9d36-036299d96c6d",
            "sourceStep": "\/api\/3\/workflow_steps\/3019b0d0-df56-4738-b599-8752a82af23e",
            "label": null,
            "isExecuted": false,
            "uuid": "733cef6c-8cfa-4c10-965f-750c22b8640d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Malicious -> Is Referenced",
            "targetStep": "\/api\/3\/workflow_steps\/dd6f68af-fb89-41c3-9d36-036299d96c6d",
            "sourceStep": "\/api\/3\/workflow_steps\/f9efb396-4f6d-496e-95b7-8132b4357f86",
            "label": null,
            "isExecuted": false,
            "uuid": "c633fae2-1d79-4460-9aec-dbafbf5be310"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious -> Set No Reputation",
            "targetStep": "\/api\/3\/workflow_steps\/3d7cb74b-d060-4933-9ebe-67579f88452b",
            "sourceStep": "\/api\/3\/workflow_steps\/ddc214f4-d9c0-4600-b2e9-af0df3bc0377",
            "label": "No Reputation",
            "isExecuted": false,
            "uuid": "cf12ccd8-87a8-458c-a45e-ae66ed2f591c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious -> Set Malicious",
            "targetStep": "\/api\/3\/workflow_steps\/f9efb396-4f6d-496e-95b7-8132b4357f86",
            "sourceStep": "\/api\/3\/workflow_steps\/ddc214f4-d9c0-4600-b2e9-af0df3bc0377",
            "label": "Malicious",
            "isExecuted": false,
            "uuid": "47364d59-b546-4e1e-a7cb-61f3d2300184"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Upon Create -> Summary",
            "targetStep": "\/api\/3\/workflow_steps\/ff1cda79-4318-46df-afd2-febe2d72c076",
            "sourceStep": "\/api\/3\/workflow_steps\/dd6f68af-fb89-41c3-9d36-036299d96c6d",
            "label": "Referenced",
            "isExecuted": false,
            "uuid": "76ffedcc-f798-4033-8811-8c3b0cf0ae0e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set No Reputation -> Is Referenced",
            "targetStep": "\/api\/3\/workflow_steps\/dd6f68af-fb89-41c3-9d36-036299d96c6d",
            "sourceStep": "\/api\/3\/workflow_steps\/3d7cb74b-d060-4933-9ebe-67579f88452b",
            "label": null,
            "isExecuted": false,
            "uuid": "4a944e10-7127-4aa7-a07f-2247c9852104"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is the record for a dedicated tenant -> Exit",
            "targetStep": "\/api\/3\/workflow_steps\/678a25cd-14af-49c7-9ea8-c3452585b910",
            "sourceStep": "\/api\/3\/workflow_steps\/50a9c51c-6dbb-412c-83b3-fad2d88a9392",
            "label": "Yes, Enrich at Tenant Node",
            "isExecuted": false,
            "uuid": "11fb57ca-9ddf-4e00-9040-5bc2cda0eaa5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Is Dedicated Tenant Record",
            "targetStep": "\/api\/3\/workflow_steps\/50a9c51c-6dbb-412c-83b3-fad2d88a9392",
            "sourceStep": "\/api\/3\/workflow_steps\/3a4098d5-3ec4-42bc-94e2-8f63bfed103f",
            "label": null,
            "isExecuted": false,
            "uuid": "66d32cd4-9790-4e3d-ac3c-549f7cafe91c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious -> Set Good",
            "targetStep": "\/api\/3\/workflow_steps\/90602b79-d420-44dd-95ad-c06e6c107585",
            "sourceStep": "\/api\/3\/workflow_steps\/ddc214f4-d9c0-4600-b2e9-af0df3bc0377",
            "label": "Good",
            "isExecuted": false,
            "uuid": "3d6cff9c-7b99-403d-bb29-655f414c2a42"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Reputation Data -> Is Malicious",
            "targetStep": "\/api\/3\/workflow_steps\/ddc214f4-d9c0-4600-b2e9-af0df3bc0377",
            "sourceStep": "\/api\/3\/workflow_steps\/8c18e496-91ba-4f0c-8301-917829cc2060",
            "label": null,
            "isExecuted": false,
            "uuid": "8c21c6db-0221-4718-9445-d12990ed89f9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Referenced -> Update Record",
            "targetStep": "\/api\/3\/workflow_steps\/f250ed61-15a3-458b-9436-7480c809f3ef",
            "sourceStep": "\/api\/3\/workflow_steps\/dd6f68af-fb89-41c3-9d36-036299d96c6d",
            "label": "Upon Create",
            "isExecuted": false,
            "uuid": "589d117c-d34b-416f-aec7-24847840c8d7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Dedicated Tenant Record -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/fbe06a74-ed1b-4e6c-9ab6-98350daed35f",
            "sourceStep": "\/api\/3\/workflow_steps\/50a9c51c-6dbb-412c-83b3-fad2d88a9392",
            "label": "No, Enrich here",
            "isExecuted": false,
            "uuid": "96035bc1-8092-4567-be73-bd39ff98c921"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Update Enrichment Status to In Progress",
            "targetStep": "\/api\/3\/workflow_steps\/e7e931fb-79a9-422a-beb2-bfcee6012817",
            "sourceStep": "\/api\/3\/workflow_steps\/fbe06a74-ed1b-4e6c-9ab6-98350daed35f",
            "label": null,
            "isExecuted": false,
            "uuid": "278f5f8c-b201-4274-aab4-018d65c3fa4b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Enrichment Playbooks List -> Initialize Enrichment Playbooks List",
            "targetStep": "\/api\/3\/workflow_steps\/2e62a551-037c-4a68-ade3-a6cf4186a487",
            "sourceStep": "\/api\/3\/workflow_steps\/38b44efe-c444-42c9-b0d9-a8efbfe3a0c6",
            "label": null,
            "isExecuted": false,
            "uuid": "5ef82ce9-8909-4e66-8563-ee4d7db26a15"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Enrichment Status to In Progress -> Identify Enrichment Playbooks List",
            "targetStep": "\/api\/3\/workflow_steps\/95b508b7-10bc-4794-abd4-d75663111f73",
            "sourceStep": "\/api\/3\/workflow_steps\/e7e931fb-79a9-422a-beb2-bfcee6012817",
            "label": null,
            "isExecuted": false,
            "uuid": "539c7a71-5f6d-49d4-a7bb-9716e2f0beb3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Identify Enrichment Playbooks List -> Is Supported Indicator Type",
            "targetStep": "\/api\/3\/workflow_steps\/50ce2052-a344-4374-9b94-e528860c111f",
            "sourceStep": "\/api\/3\/workflow_steps\/95b508b7-10bc-4794-abd4-d75663111f73",
            "label": null,
            "isExecuted": false,
            "uuid": "2c971333-024a-4d97-b8e7-1419f1890f76"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Supported Indicator Type -> Get Enrichment Playbooks List",
            "targetStep": "\/api\/3\/workflow_steps\/38b44efe-c444-42c9-b0d9-a8efbfe3a0c6",
            "sourceStep": "\/api\/3\/workflow_steps\/50ce2052-a344-4374-9b94-e528860c111f",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "71a508d6-fdda-48de-ab48-1f5d27811f10"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Supported Indicator Type -> Exit",
            "targetStep": "\/api\/3\/workflow_steps\/a61c987a-3864-49a0-b0b9-8802e00805d2",
            "sourceStep": "\/api\/3\/workflow_steps\/50ce2052-a344-4374-9b94-e528860c111f",
            "label": "No",
            "isExecuted": false,
            "uuid": "c53ce92f-7040-4e07-ba72-1e55459a4470"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Type IP -> Additional Checks for IP",
            "targetStep": "\/api\/3\/workflow_steps\/5e280ff6-13e6-49eb-878a-217923163080",
            "sourceStep": "\/api\/3\/workflow_steps\/ba6f3981-1789-4635-8784-02b7ad23f655",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "23b15ab7-8964-4383-97b2-a0187403db21"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Initialize Enrichment Playbooks List -> Is Type IP",
            "targetStep": "\/api\/3\/workflow_steps\/ba6f3981-1789-4635-8784-02b7ad23f655",
            "sourceStep": "\/api\/3\/workflow_steps\/2e62a551-037c-4a68-ade3-a6cf4186a487",
            "label": null,
            "isExecuted": false,
            "uuid": "540e7413-e8b2-4b46-9b65-6ebb1f9ebef2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Type IP -> Integrations Available for Enrichment",
            "targetStep": "\/api\/3\/workflow_steps\/ea51391e-d9b2-4af6-ac63-497e61419238",
            "sourceStep": "\/api\/3\/workflow_steps\/ba6f3981-1789-4635-8784-02b7ad23f655",
            "label": "No",
            "isExecuted": false,
            "uuid": "770de2f5-b9c9-4cda-9cc7-0fc115c5e991"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Record -> Update Field Mapping",
            "targetStep": "\/api\/3\/workflow_steps\/acc4c661-464c-4c5d-b58d-b0e7a88008ee",
            "sourceStep": "\/api\/3\/workflow_steps\/f250ed61-15a3-458b-9436-7480c809f3ef",
            "label": null,
            "isExecuted": false,
            "uuid": "6ac9d548-8101-4c70-8fe5-66909136cda9"
        }
    ],
    "groups": [],
    "priority": null,
    "uuid": "02000b45-97fc-47f2-a8a7-5b03d2625898",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Enrichment"
    ]
}